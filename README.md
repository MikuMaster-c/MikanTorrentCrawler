# 蜜柑计划种子爬虫工具 - MikanTorrentCrawler

## 项目介绍

这是一个用于爬取 `蜜柑计划` 网站种子文件的 Python 爬虫工具.可以爬取种子文件并保存在本地.同时支持代理设置以及多线程下载.

## 功能

- **页面抓取**:可以抓取 `Mikan` 网站上的`class`页面并解析种子下载链接.
- **代理**:可选配置 HTTP/HTTPS 代理.
- **多线程**:支持并发爬取多个页面和下载种子文件.
- **流量监控**:实时显示请求次数(RPS)和下载流量.
- **日志保存**:每次爬取的页面信息都会保存到日志里.

## 环境要求

- Python 3.x

- 安装必要的库:

  ```bash
  pip install -r requirements.txt
  ```

## 使用方法

1. **运行爬虫**

   在命令行终端中运行以下命令:

   ```bash
   python main.py
   ```

2. **输入配置**

   程序会提示输入以下配置:

   - **最大并行数**:设置同时爬取的最大线程数.可以根据网络情况和计算机性能来调整.
   - **是否使用代理**:选择是否启用代理,输入 `y` 或 `n`.
   - **代理信息**:如果选择使用代理,输入代理的 `host`, `port`, `username` 和 `password`.
   - **开始页面**:输入爬取的起始页面编号.
   - **结束页面**:输入爬取的结束页面编号.

   示例:

   ```
   输入最大并行数: 10
   是否使用代理? (y/n): n
   start: 1
   end: 100
   ```

3. **查看报告**

   爬虫会显示以下信息:

   - 每秒请求数（RPS）
   - 下载速度（MB/s）
   - 当前页面的爬取时间
   - 每下载一个种子文件,都会显示下载路径和状态.

4. **日志保存**

   程序会把已爬取的页面编号保存到日志文件 `爬取日志.txt` 中.

## 代码结构

- **Mikan 类**:主要爬虫逻辑,包含页面抓取,种子下载,代理配置,日志管理.
- **get_page**:发起 HTTP 请求,获取页面内容.
- **page_page**:解析页面中的种子链接,发起多线程下载.
- **process_page**:下载保存种子文件.
- **save_log**:保存当前爬取的页面到日志.
- **report_rps**:统计显示RPS和下载速度.
- **calculate_avg_page_time**:计算显示最近三页的平均爬取时长.

## 示例输出

```
输入最大并行数: 10
是否使用代理? (y/n): n
start: 1
end: 5
正在爬取第 1 页...
当前RPS: 5.12 请求/秒
最近10秒的平均流量: 0.20 MB/s
--------------------第1页爬取成功!--------------------
正在爬取第 2 页...
当前RPS: 6.45 请求/秒
最近10秒的平均流量: 0.22 MB/s
--------------------第2页爬取成功!--------------------
...
```

## 注意事项

- 不要设置过大的并行数.
- 网址可能有变,替换URL即可.

## 许可证

本项目使用 MIT 许可证,详情请查看 [LICENSE](LICENSE) 文件.

---

欢迎提交问题和建议,感谢使用!
